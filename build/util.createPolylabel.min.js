ymaps.modules.define("src.config",[],function(e){e({MIN_ZOOM:0,MAX_ZOOM:19,options:["labelLayout","labelDotLayout","labelClassName","labelForceVisible","labelTextColor","labelTextSize","labelCenterCoords","labelOffset","labelPermissibleInaccuracyOfVisibility"],properties:[]})}),ymaps.modules.define("src.label.GeoObjectCollection.Label",["util.extend","util.objectKeys","Placemark","src.label.util.LabelPlacemarkOverlay","src.label.util.createLabelLayoutTemplate","src.label.util.createDotLayoutTemplate","src.label.util.getLabelLayout"],function(e,t,o,n,i,a,l,r){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e(function(){function e(t,o,n,i,a){if(s(this,e),!t||!i)throw new Error("wrong argument");this._polygon=t,this._parentCollection=i,this._placemark={label:null,dot:null},this._layout={label:null,dot:null},this._init(o,n,a)}return e.prototype.getPlacemark=function(){return this._placemark},e.prototype.getLayout=function(){return this._layout},e.prototype.removeFromCollection=function(){var e=this;this._parentCollection&&["label","dot"].forEach(function(t){-1!==e._parentCollection.indexOf(e._placemark[t])&&e._parentCollection.remove(e._placemark[t])})},e.prototype.addToCollection=function(){var e=this;if(!this._parentCollection)return Promise.reject();var t=["label","dot"].map(function(t){return e._placemark[t].getParent()||e._parentCollection.add(e._placemark[t]),r(e._placemark[t]).then(function(o){e._layout[t]=o})});return Promise.all(t)},e.prototype._init=function(t,o,n){var i=this._getLayoutTemplate(t,n),a=i.labelLayout,l=i.labelDotLayout;this._placemark.label=e._createPlacemark({properties:{_labelPolygon:this._polygon},options:t},a),this._placemark.dot=e._createPlacemark({properties:{_labelPolygon:this._polygon}},l)},e.prototype._getLayoutTemplate=function(e,t){var o={labelLayout:a,labelDotLayout:l};return["labelLayout","labelDotLayout"].reduce(function(n,i){var a=e[i],l=a||"default"+i;if(t[l])n[i]=t[l];else{var r=o[i](a);n[i]=r,t[l]=r}return n},{})},e._createPlacemark=function(e,o){var a=t({},{iconLayout:o,iconLabelPosition:"absolute",pointOverlay:i},e.options);return new n([0,0],e.properties,a)},e.prototype.setLayoutTemplate=function(e){var t=this,n={label:a,dot:l};return Promise.all(o(e).map(function(o){var i=n[o](e[o]);t._placemark[o].getParent()&&t._placemark[o].options.set({iconLayout:i})}))},e.prototype.setCoordinates=function(e){var t=this;e.toString()!==this._placemark.label.geometry.getCoordinates().toString()&&["dot","label"].forEach(function(o){t._placemark[o].geometry.setCoordinates(e)})},e.prototype.setVisibility=function(e){var t=this;o(this._placemark).forEach(function(o){var n=o===e?"places":"phantom";t._placemark[o].options.set({pane:n})})},e.prototype.setStyles=function(e){this._placemark.label.options.set({iconLabelClassName:e.className,iconLabelTextSize:e.textSize,iconLabelTextColor:e.textColor})},e.prototype.centerAndSetIconShape=function(e,t,o){var n=t.height/2,i=t.width/2;this._placemark[e].options.set({iconShape:{type:"Rectangle",coordinates:[[-i+o[1],-n+o[0]],[i+o[1],n+o[0]]]},iconLabelTop:-n+o[0],iconLabelLeft:-i+o[1]})},e.prototype.destroy=function(){this.removeFromCollection()},e}())}),ymaps.modules.define("src.label.util.createDotLayoutTemplate",["templateLayoutFactory"],function(e,t){e(function(e){return void 0===e&&(e="<div {% style %}background-color: red; width: 10px; height: 10px; border-radius: 50px;{% endstyle %}></div>"),t.createClass("\n    <div {% style %}position: {{options.labelPosition}}; top: {{options.labelTop}}px; left: {{options.labelLeft}}px; {% endstyle %}>\n        "+e+"\n    </div>")})}),ymaps.modules.define("src.label.util.createLabelLayoutTemplate",["templateLayoutFactory"],function(e,t){e(function(e){return t.createClass('\n    <div {% style %}position: {{options.labelPosition}}; top: {{options.labelTop}}px; left: {{options.labelLeft}}px; {% endstyle %}>\n        <div class="{{options.labelClassName}}"\n            {% style %}font-size: {{options.labelTextSize}}px; color: {{options.labelTextColor}}; {% endstyle %}>\n            '+e+"\n        </div>\n    </div>")})}),ymaps.modules.define("src.label.util.getLabelLayout",[],function(e){e(function(e){return e.getOverlay().then(function(e){return e.getLayout()})})}),ymaps.modules.define("src.label.util.getLayoutSize",[],function(e){e(function(e){var t=e.getElement().children[0].getBoundingClientRect();return{width:t.width,height:t.height}})}),ymaps.modules.define("src.label.util.LabelPlacemarkOverlay",["util.defineClass","overlay.Placemark","option.Manager"],function(e,t,o,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}e(function(e){function o(t,n,l){return i(this,o),a(this,e.call(this,t,n,l))}return t(o,e),o.prototype.getData=function(){var e=this._data.geoObject.properties.get("_labelPolygon");return{geoObject:e,geometry:e.geometry,properties:e.properties,state:e.state}},o}(o))}),ymaps.modules.define("src.polylabel.PolylabelBased",["src.config","GeoObject"],function(e,t,o){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e(function(){function e(t){n(this,e),this._map=t}return e.prototype.initMapListeners=function(e){this._mapBoundsChangeCallback=e,this._map.events.add("boundschange",this._mapBoundsChangeHandler,this)},e.prototype.destroyMapListeners=function(){this._map.events.remove("boundschange",this._mapBoundsChangeHandler,this)},e.prototype._mapBoundsChangeHandler=function(e){e.get("newZoom")!==e.get("oldZoom")&&this._mapBoundsChangeCallback()},e.prototype.getOptions=function(e){return t.options.reduce(function(t,n){return t[n]=e instanceof o?e.options.get(n):e.options[n],t},{})},e.prototype.getProperties=function(e){return t.properties.reduce(function(t,n){return t[n]=e instanceof o?e.properties.get(n):e.properties[n],t},{})},e}())}),ymaps.modules.define("src.polylabel.PolylabelCollection",["util.defineClass","util.objectKeys","src.polylabel.PolylabelBased","src.label.GeoObjectCollection.Label","src.util.center.setCenter","src.util.style.setOffset","src.util.style.setPermissibleInaccuracyOfVisibility","src.util.zoom.setZoomVisibilityForGeoObject","src.util.zoom.setForceVisibleZoom","src.util.zoom.parseZoomData","src.util.createDefaultLabelData","GeoObjectCollection","Monitor","system.nextTick","data.Manager","event.Manager","Event"],function(e,t,o,n,i,a,l,r,s,c,u,f,p,y,b,h,d,m){function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}e(function(e){function n(t,o){g(this,n);var i=_(this,e.call(this,t));return i._map=t,i._labelsCollection=new p,i._labelsState=new WeakMap,i._polygonsCollection=o,i._currentConfiguredVisibility=new WeakMap,i._currentVisibility=new WeakMap,i._layoutTemplateCache={},i._initData(),i}return t(n,e),n.prototype.destroy=function(){this._deleteLabelStateListeners(),this._deletePolygonsListeners(),this._deletePolygonCollectionListeners(),this._deleteLabelCollection(),this._map.geoObjects.remove(this._labelsCollection)},n.prototype.getLabelState=function(e){return this._labelsState.get(e)},n.prototype.getConfiguredVisibility=function(e){return this._currentConfiguredVisibility.get(e)},n.prototype.getCurrentVisibility=function(e){return this._currentVisibility.get(e)},n.prototype._initData=function(){var e=this;this._map.geoObjects.add(this._labelsCollection),this._firstCalculatePolygonsCollection().then(function(){e._initMapListeners(),e._initPolygonCollectionListeners(),e._initPolygonsListeners(),e._initLabelCollectionListeners()})},n.prototype._firstCalculatePolygonsCollection=function(){var e=this;this._clearLabelCollection();var t=[];return this._polygonsCollection.each(function(o){e._setLabelState(o,"visible",void 0),e._initLabelStateListener(o),e._calculatePolygonLabelData(o).then(function(n){e._setLabelState(o,"_labelData",n),t.push(e._analyzeAndSetLabelData(e._map,o,e._getLabelState(o,"_labelData")))})}),Promise.all(t)},n.prototype._calculatePolygonsCollection=function(){var e=this,t=[];return this._polygonsCollection.each(function(o){t.push(e._analyzeAndSetLabelData(e._map,o,e._getLabelState(o,"_labelData")))}),Promise.all(t)},n.prototype._clearLabelCollection=function(){this._labelsCollection.removeAll(),this._labelsCollection.options.set({pane:"phantom"})},n.prototype._deleteLabelCollection=function(){var e=this;this._polygonsCollection.each(function(t){e._getLabelState(t,"_labelData").label.destroy()}),this._clearLabelCollection()},n.prototype._calculatePolygonLabelData=function(e,t){var n=this,p=this.getOptions(e),y=this.getProperties(e),b=f();c(b,p.labelForceVisible);var h=e.geometry.getCoordinates();a(b,h,p.labelCenterCoords),l(b,p.labelOffset),r(b,p.labelPermissibleInaccuracyOfVisibility);var d=void 0;return d=t?this._getLabelState(e,"_labelData").label:new i(e,p,y,this._labelsCollection,this._layoutTemplateCache),b.label=d,d.addToCollection().then(function(){var e=p.labelClassName,t=p.labelTextColor,n=p.labelTextSize;e=u(e),n=u(n),t=u(t),o(b.zoomInfo).forEach(function(o){b.zoomInfo[o].style={className:e?e[o]:"",textSize:n?n[o]:"",textColor:t?t[o]:""}})}).then(function(){return s(n._map,b,h[b.polygonIndex],d)}).then(function(){return b})},n.prototype._analyzeAndSetLabelData=function(e,t,o,n){if(!o)return Promise.resolve();var i=o.zoomInfo,a=o.autoCenter,l=o.label;i=i[e.getZoom()],this._setCurrentConfiguredVisibility(t,i.visible,i.visibleForce),l.setCoordinates(i.center||a);var r="auto"===(n=n||i.visibleForce)?i.visible:n;return this._setCurrentVisibility(t,r),l.setVisibility(r),["dot","label"].includes(r)&&l.centerAndSetIconShape(r,"dot"===r?o.dotSize:i.labelSize,i.labelOffset),l.setStyles(i.style),Promise.resolve()},n.prototype._setCurrentConfiguredVisibility=function(e,t,o){var n=o&&-1!==["dot","label","none"].indexOf(o)?o:t;this._currentConfiguredVisibility.set(e,n)},n.prototype._setCurrentVisibility=function(e,t){this._currentVisibility.set(e,-1!==["dot","label"].indexOf(t)?t:"none")},n.prototype._recalculateNewPolygon=function(e){var t=this;this._calculatePolygonLabelData(e).then(function(o){t._setLabelState(e,"_labelData",o),t._analyzeAndSetLabelData(t._map,e,t._getLabelState(e,"_labelData"))})},n.prototype._setLabelState=function(e,t,o){var n=this._labelsState.get(e);n||(n=new h,this._labelsState.set(e,n)),n.set(t,o)},n.prototype._getLabelState=function(e,t){var o=this._labelsState.get(e);if(o)return o.get(t)},n.prototype._clearVisibilityInLabelsState=function(){var e=this;this._polygonsCollection.each(function(t){e._setLabelState(t,"visible",void 0)})},n.prototype._polygonCollectionEventHandler=function(e){switch(e.get("type")){case"add":this._recalculateNewPolygon(e.get("child"));break;case"remove":var t=this._getLabelState(e.get("child"),"_labelData");t&&t.label.destroy()}},n.prototype._deleteLabelStateListeners=function(){var e=this;this._polygonsCollection.each(function(t){e._deleteLabelStateListener(t)})},n.prototype._deleteLabelStateListener=function(e){var t=this._getLabelState(e,"labelMonitor");t&&t.removeAll()},n.prototype._initLabelStateListener=function(e){var t=this,o=new y(this._labelsState.get(e));this._setLabelState(e,"labelMonitor",o),o.add("visible",function(o){t._analyzeAndSetLabelData(t._map,e,t._getLabelState(e,"_labelData"),o)})},n.prototype._initPolygonsListeners=function(){var e=this;this._polygonsCollection.each(function(t){e._initPolygonListener(t)})},n.prototype._initPolygonListener=function(e){e.events.add(["optionschange","propertieschange"],this._onPolygonOptionsChangeHandler,this),e.events.add("parentchange",this._onPolygonParentChangeHandler,this)},n.prototype._onPolygonParentChangeHandler=function(e){this._isPolygonParentChange=!0},n.prototype._onPolygonOptionsChangeHandler=function(e){var t=this;b(function(){var o=e.get("target"),n=t._getLabelState(o,"_labelData");!t._isPolygonParentChange&&n?(n.label.setVisibility("phantom"),n.label.setLayoutTemplate({label:o.options.get("labelLayout"),dot:o.options.get("labelDotLayout")}).then(function(){return t._calculatePolygonLabelData(o,!0)}).then(function(e){t._setLabelState(o,"_labelData",e),t._analyzeAndSetLabelData(t._map,o,t._getLabelState(o,"_labelData"))})):t._isPolygonParentChange=!1})},n.prototype._initPolygonCollectionListeners=function(){this._polygonsCollection.events.add(["add","remove"],this._polygonCollectionEventHandler,this)},n.prototype._initLabelCollectionListeners=function(){var e=new d({controllers:[{onBeforeEventFiring:function(e,t,o){if("phantom"===o.get("target").options.get("pane"))return!1;var n=o.get("target").properties.get("_labelPolygon");if(n){var i=new m({target:n,type:"label"+t},o);n.events.fire("label"+t,i)}return!1}}]});this._labelsCollection.events.setParent(e)},n.prototype._initMapListeners=function(){var e=this;this.initMapListeners(function(){e._clearVisibilityInLabelsState(),e._calculatePolygonsCollection()})},n.prototype._deletePolygonCollectionListeners=function(){this._polygonsCollection.events.remove(["add","remove"],this._polygonCollectionEventHandler,this),this.destroyMapListeners()},n.prototype._deletePolygonsListeners=function(){var e=this;this._polygonsCollection.each(function(t){e._deletePolygonListener(t)})},n.prototype._deletePolygonListener=function(e){e.events.remove(["optionschange","propertieschange"],this._onPolygonOptionsChangeHandler,this),e.events.remove("parentchange",this._onPolygonParentChangeHandler,this)},n}(n))}),ymaps.modules.define("src.polylabel.PolylabelObjectManager",[],function(e){e(function(){})}),ymaps.modules.define("util.createPolylabel",["src.polylabel.PolylabelCollection","src.polylabel.PolylabelObjectManager","ObjectManager"],function(e,t,o,n){e(function(e,i){return i instanceof n?new o(e,i):new t(e,i)})}),ymaps.modules.define("src.util.center.setCenter",["util.array","util.objectKeys","src.util.getPolesOfInaccessibility","src.util.zoom.parseZoomData"],function(e,t,o,n,i){var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e(function(e,l,r){var s=n(l,1);if(e.autoCenter=s.center,e.polygonIndex=s.index,t.isArray(r))o(e.zoomInfo).forEach(function(t){e.zoomInfo[t].center=r});else if(r&&"object"===(void 0===r?"undefined":a(r))){var c=i(r);o(c).forEach(function(t){void 0!==c[t]&&(e.zoomInfo[t].center=c[t])})}})}),ymaps.modules.define("src.util.checkPointPosition",[],function(e){function t(e,t,a){var l=o(a,t),r=o(e,t),s=l[0]*r[1]-r[0]*l[1];return s>0?"LEFT":s<0?"RIGHT":l[0]*r[0]<0||l[1]*r[1]<0?"BEHIND":n(l)<n(r)?"BEYOND":i(t,e)?"ORIGIN":i(a,e)?"DESTINATION":"BETWEEN"}function o(e,t){return[e[0]-t[0],e[1]-t[1]]}function n(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}function i(e,t){return e[0]===t[0]&&e[1]===t[1]}function a(e,o){var n=o[0],i=o[1];switch(t(e,n,i)){case"LEFT":return n[1]<e[1]&&e[1]<=i[1]?"CROSSING":"INESSENTIAL";case"RIGHT":return i[1]<e[1]&&e[1]<=n[1]?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}}e(function(e,t){for(var o=0,n=0;n<t.length-1;n++)switch(a(e,[t[n],t[n+1]])){case"TOUCHING":return"BOUNDARY";case"CROSSING":o=1-o}return o?"INSIDE":"OUTSIDE"})}),ymaps.modules.define("src.util.createDefaultLabelData",["src.config"],function(e,t){var o=t.MIN_ZOOM,n=t.MAX_ZOOM;e(function(){for(var e={zoomInfo:{},autoCenter:[0,0],polygonIndex:0,dotSize:{height:0,width:0}},t=o;t<=n;t++)e.zoomInfo[t]={visible:"none",visibleForce:"auto",center:void 0,style:{className:void 0,textSize:void 0,textColor:void 0},labelSize:{height:0,width:0},labelOffset:[0,0],permissibleInaccuracyOfVisibility:0};return e})}),ymaps.modules.define("src.util.getPolesOfInaccessibility",["util.calculateArea"],function(e,t){function o(e,t){if(!(this instanceof o))return new o(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||n,this.length>0)for(var i=this.length>>1;i>=0;i--)this._down(i)}function n(e,t){return e<t?-1:e>t?1:0}function i(e,t,o){t=t||1;for(var n,i,r,c,f=0;f<e[0].length;f++){var p=e[0][f];(!f||p[0]<n)&&(n=p[0]),(!f||p[1]<i)&&(i=p[1]),(!f||p[0]>r)&&(r=p[0]),(!f||p[1]>c)&&(c=p[1])}var y=r-n,b=c-i,h=Math.min(y,b),d=h/2,m=new u(null,a);if(0===h)return[n,i];for(var g=n;g<r;g+=h)for(var _=i;_<c;_+=h)m.push(new l(g+d,_+d,d,e));var v=s(e),L=new l(n+y/2,i+b/2,0,e);L.d>v.d&&(v=L);for(var C=m.length;m.length;){var S=m.pop();S.d>v.d&&(v=S,o&&console.error("found best %d after %d probes",Math.round(1e4*S.d)/1e4,C)),S.max-v.d<=t||(d=S.h/2,m.push(new l(S.x-d,S.y-d,d,e)),m.push(new l(S.x+d,S.y-d,d,e)),m.push(new l(S.x-d,S.y+d,d,e)),m.push(new l(S.x+d,S.y+d,d,e)),C+=4)}return o&&(console.error("num probes: "+C),console.error("best distance: "+v.d)),[v.x,v.y]}function a(e,t){return t.max-e.max}function l(e,t,o,n){this.x=e,this.y=t,this.h=o,this.d=r(e,t,n),this.max=this.d+this.h*Math.SQRT2}function r(e,t,o){for(var n=!1,i=1/0,a=0;a<o.length;a++)for(var l=o[a],r=0,s=l.length,u=s-1;r<s;u=r++){var f=l[r],p=l[u];f[1]>t!=p[1]>t&&e<(p[0]-f[0])*(t-f[1])/(p[1]-f[1])+f[0]&&(n=!n),i=Math.min(i,c(e,t,f,p))}return(n?1:-1)*Math.sqrt(i)}function s(e){for(var t=0,o=0,n=0,i=e[0],a=0,r=i.length,s=r-1;a<r;s=a++){var c=i[a],u=i[s],f=c[0]*u[1]-u[0]*c[1];o+=(c[0]+u[0])*f,n+=(c[1]+u[1])*f,t+=3*f}return 0===t?new l(i[0][0],i[0][1],0,e):new l(o/t,n/t,0,e)}function c(e,t,o,n){var i=o[0],a=o[1],l=n[0]-i,r=n[1]-a;if(0!==l||0!==r){var s=((e-i)*l+(t-a)*r)/(l*l+r*r);s>1?(i=n[0],a=n[1]):s>0&&(i+=l*s,a+=r*s)}return l=e-i,r=t-a,l*l+r*r}e(function(e,o,n){if(void 0===t)throw new Error("Didn't find calculateArea module");var a=Number.MIN_VALUE,l=0,r=void 0;if(e.length>1){for(var s=0;s<e.length;s++){var c=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:[e[s]]}}),u=Math.round(t(c));a<u&&(a=u,l=s)}r=[e[l]]}else r=e;return{center:i(r,o,n),index:l}}),o.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return--this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,o=this.compare,n=t[e];e>0;){var i=e-1>>1,a=t[i];if(o(n,a)>=0)break;t[e]=a,e=i}t[e]=n},_down:function(e){for(var t=this.data,o=this.compare,n=this.length>>1,i=t[e];e<n;){var a=1+(e<<1),l=a+1,r=t[a];if(l<this.length&&o(t[l],r)<0&&(a=l,r=t[l]),o(r,i)>=0)break;t[e]=r,e=a}t[e]=i}};var u=o}),ymaps.modules.define("src.util.stringReplacer",[],function(e){e(function(e,t){var o=e;return t.forEach(function(e,t){o=o.replace(new RegExp("\\$"+(t+1),"g"),e)}),o})}),ymaps.modules.define("src.util.style.setOffset",["util.array","util.objectKeys","src.util.zoom.parseZoomData"],function(e,t,o,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e(function(e,a){if(t.isArray(a))o(e.zoomInfo).forEach(function(t){e.zoomInfo[t].labelOffset=a});else if(a&&"object"===(void 0===a?"undefined":i(a))){var l=n(a);o(l).forEach(function(t){void 0!==l[t]&&(e.zoomInfo[t].labelOffset=l[t])})}})}),ymaps.modules.define("src.util.style.setPermissibleInaccuracyOfVisibility",["util.objectKeys","src.util.zoom.parseZoomData"],function(e,t,o){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e(function(e,i){if("number"==typeof i)t(e.zoomInfo).forEach(function(t){e.zoomInfo[t].permissibleInaccuracyOfVisibility=i});else if(i&&"object"===(void 0===i?"undefined":n(i))){var a=o(i);t(a).forEach(function(t){void 0!==a[t]&&(e.zoomInfo[t].permissibleInaccuracyOfVisibility=a[t])})}})}),ymaps.modules.define("src.util.zoom.getFirstZoomInside",["src.util.checkPointPosition","src.config"],function(e,t,o){function n(e,t,o,n,i,a){var l=isNaN(Number(a))?0:Number(a),r=e.options.get("projection").toGlobalPixels(t,o),s=n.width,c=n.height;c+=i[0],s+=i[1];var u=[],f=[];return u.push([r[0]-s/2,r[1]-c/2],[r[0]-s/2,r[1]+c/2],[r[0]+s/2,r[1]-c/2],[r[0]+s/2,r[1]+c/2]),f.push([u[0][0]+l>r[0]?r[0]:u[0][0]+l,u[0][1]+l>r[1]?r[1]:u[0][1]+l],[u[1][0]+l>r[0]?r[0]:u[1][0]+l,u[1][1]-l<r[1]?r[1]:u[1][1]-l],[u[2][0]-l<r[0]?r[0]:u[2][0]-l,u[2][1]+l>r[1]?r[1]:u[2][1]+l],[u[3][0]-l<r[0]?r[0]:u[3][0]-l,u[3][1]-l<r[1]?r[1]:u[3][1]-l]),{normal:u,withInaccuracy:f}}function i(e,o,n,i){for(var a=0;a<n.length;a++){var l=e.options.get("projection").fromGlobalPixels(n[a],i);if("INSIDE"!==t(l,o))return!1}return!0}e(function(e,t,a,l,r,s){for(var c=o.MIN_ZOOM,u=o.MAX_ZOOM,f=void 0;c<u;){var p=n(e,t,f=Math.floor((c+u)/2),l,r||[0,0],s);i(e,a,p.normal,f)||i(e,a,p.withInaccuracy,f)?u=f:c=f+1}return c})}),ymaps.modules.define("src.util.zoom.parseZoomData",["util.objectKeys","src.config"],function(e,t,o){function n(e,t,o){e[t]=o}function i(e,t,o){if(isNaN(Number(t))){var n=t.split("_").map(Number);if(!isNaN(n[0])&&!isNaN(n[1]))for(var i=n[0]<r?r:n[0],a=n[1]>s?s:n[1];i<=a;)e[i]=o,i++}else e[Number(t)]=o}function a(e){for(var t=r,o={};t<=s;)o[t]=e,t++;return o}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=o.MIN_ZOOM,s=o.MAX_ZOOM;e(function(e){var o=["number","string","boolean"];return"[object Object]"===Object.prototype.toString.call(e)?t(e).reduce(function(t,o){return"string"==typeof o?i(t,o,e[o]):"number"==typeof o&&n(t,o,e[o]),t},a()):o.includes(void 0===e?"undefined":l(e))?a(e):void 0})}),ymaps.modules.define("src.util.zoom.setForceVisibleZoom",["util.objectKeys","src.util.zoom.parseZoomData"],function(e,t,o){e(function(e,n){if("string"==typeof n)t(e.zoomInfo).forEach(function(t){e.zoomInfo[t].visibleForce=n});else if("[object Object]"===Object.prototype.toString.call(n)){var i=o(n);t(i).forEach(function(t){void 0!==i[t]&&(e.zoomInfo[t].visibleForce=i[t])})}})}),ymaps.modules.define("src.util.zoom.setZoomVisibility",["util.objectKeys","src.util.zoom.getFirstZoomInside"],function(e,t,o){e(function(e,n,i,a){var l=o(e,n.autoCenter,i,a);t(n.zoomInfo).forEach(function(t){if(n.zoomInfo[t].center){var r=o(e,n.zoomInfo[t].center,i,a);n.zoomInfo[t].visible=t>=r}else n.zoomInfo[t].visible=t>=l})})}),ymaps.modules.define("src.util.zoom.setZoomVisibilityForGeoObject",["util.objectKeys","src.util.zoom.getFirstZoomInside","src.label.util.getLayoutSize"],function(e,t,o,n){function i(e,t,o){var n=["none","dot","label"],i=e;return o&&(i=n.indexOf(t)>n.indexOf(e)?t:e),i}function a(e,n,a,l,r,s){t(a.zoomInfo).forEach(function(t){var n=a.zoomInfo[t],r=void 0;r=n.center?o(e,n.center,l,s,n.labelOffset,n.permissibleInaccuracyOfVisibility):o(e,a.autoCenter,l,s,n.labelOffset,n.permissibleInaccuracyOfVisibility),n.visible=i(n.visible,"dot",t>=r)})}function l(e,t,a,l,r,s){var c=a.zoomInfo[l];t.setStyles(c.style);var u=n(s);c.labelSize=u;var f=o(e,c.center||a.autoCenter,r,u,c.labelOffset,c.permissibleInaccuracyOfVisibility);c.visible=i(c.visible,"label",l>=f)}e(function(e,o,i,r){var s=n(r.getLayout().dot);return o.dotSize=s,a(e,0,o,i,r.getLayout().dot,s),t(o.zoomInfo).forEach(function(t){l(e,r,o,t,i,r.getLayout().label)}),Promise.resolve()})});