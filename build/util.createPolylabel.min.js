ymaps.modules.define("setCenter",["util.array","util.objectKeys","getPolesOfInaccessibility","parseZoomData"],function(t,e,o,n,i){t(function(t,a,l){var s=n(a,1);if(t.autoCenter=s.center,t.polygonIndex=s.index,e.isArray(l))o(t.zoomInfo).forEach(function(e){t.zoomInfo[e].center=l});else if("[object Object]"===Object.prototype.toString.call(l)){var r=i(l);o(r).forEach(function(e){void 0!==r[e]&&(t.zoomInfo[e].center=r[e])})}})}),ymaps.modules.define("config",[],function(t){t({MIN_ZOOM:0,MAX_ZOOM:19,options:["labelLayout","labelDotLayout","labelClassName","labelForceVisible","labelTextColor","labelTextSize"],properties:["labelCenterCoords"]})}),ymaps.modules.define("Label",["util.extend","Placemark","XPlacemark","createLabelLayoutTemplate"],function(t,e,o,n,i){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(o,n,i,l){if(a(this,t),!o||!l)throw new Error("wrong argument");this._geoObject=o,this._parentCollection=l,this._options=e({},n),this._properties=e({},i),this._label=null,this._size={width:0,height:0},this._initLabel()}return t.prototype.getPlacemark=function(){return this._label},t.prototype._calculateLabelSize=function(o){this.removeFromCollection();var n=o.height/2,i=o.width/2;this._setSize(o),this._label=t._createPlacemark({options:e({},this._label.options.getAll(),{iconShape:{type:"Rectangle",coordinates:[[-i,-n],[i,n]]},iconTop:-n,iconLeft:-i})}),this.addToCollection()},t.prototype._setSize=function(t){this._size.width=t.width,this._size.height=t.height},t.prototype.removeFromCollection=function(){if(!this._parentCollection||-1===this._parentCollection.indexOf(this._label))return!1;this._parentCollection.remove(this._label)},t.prototype.addToCollection=function(){if(!this._parentCollection)return!1;this._parentCollection.add(this._label)},t.prototype._initLabel=function(){var e=this._options.labelLayout;e=i(e),this._label=t._createPlacemark({properties:this._properties,options:this._options},e),this._label.properties.set("labelPolygon",this._geoObject)},t._createPlacemark=function(t,i){var a=t.properties,l=t.options;return l=e({},{iconLayout:i,iconLabelPosition:"absolute",pointOverlay:n},l),new o([0,0],a,l)},t.prototype._setCoordinates=function(t){t!==this._label.geometry.getCoordinates()&&this._label.geometry.setCoordinates(t)},t.prototype._setVisibility=function(t){var e=t?"places":"phantom";this._label.options.get("pane")!==e&&this._label.options.set({pane:e})},t.prototype._setStyles=function(t){var e=t.className,o=t.textColor,n=t.textSize;this._options.labelTextSize=n,this._options.labelTextColor=o,this._options.labelTextClassName=e,t.size&&(this._size.height=t.size.height||this._size.height,this._size.width=t.size.width||this._size.width),this._label.options.set(this._getTextLabelOption())},t.prototype._getTextLabelOption=function(){var t=this._options,e=t.labelTextClassName,o=t.labelTextColor,n=t.labelTextSize,i=this._size,a=i.width,l=i.height;return{iconLabelClassName:this._isObject(e)?"":e,iconLabelText:this._properties.labelText||"",iconLabelTextSize:this._isObject(n)?"":n,iconLabelTextColor:this._isObject(o)?"":o,iconTop:-l/2,iconLeft:-a/2}},t.prototype._isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},t.prototype.destroy=function(){this.removeFromCollection(),this._label=void 0},t}())}),ymaps.modules.define("LabelForCollection",["util.extend","Placemark","XPlacemark","createLabelLayoutTemplate","getLabelLayout"],function(t,e,o,n,i,a){function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(o,n,i,a){if(l(this,t),!o||!a)throw new Error("wrong argument");this._geoObject=o,this._parentCollection=a,this._options=e({},n),this._properties=e({},i),this._label=null,this._layout=null,this._size={width:0,height:0},this._initLabel()}return t.prototype.getPlacemark=function(){return this._label},t.prototype.getLayout=function(){return this._layout},t.prototype._saveSize=function(t){this._size.width=t.width,this._size.height=t.height},t.prototype.removeFromCollection=function(){if(!this._parentCollection||-1===this._parentCollection.indexOf(this._label))return!1;this._parentCollection.remove(this._label)},t.prototype.addToCollection=function(){var t=this;return new Promise(function(e,o){t._parentCollection?(t._parentCollection.add(t._label),a(t._label).then(function(o){t._layout=o,e()})):o()})},t.prototype._initLabel=function(){var o=this._options.labelLayout;o=i(o),this._label=t._createPlacemark({properties:e(this._properties,{labelPolygon:this._geoObject}),options:this._options},o)},t._createPlacemark=function(t,i){var a=t.properties,l=t.options;return l=e({},{iconLayout:i,iconLabelPosition:"absolute",pointOverlay:n},l),new o([0,0],a,l)},t.prototype._setLayout=function(t){var e=this;return new Promise(function(o){var n=i(t);e._label.options.set({iconLayout:n}),a(e._label).then(function(t){e._layout=t,o()})})},t.prototype._setCoordinates=function(t){t!==this._label.geometry.getCoordinates()&&this._label.geometry.setCoordinates(t)},t.prototype._setVisibility=function(t){var e=t?"places":"phantom";this._label.options.get("pane")!==e&&this._label.options.set({pane:e})},t.prototype._setStyles=function(t){var e=t.className,o=t.textColor,n=t.textSize;this._options.labelTextSize=n,this._options.labelTextColor=o,this._options.labelTextClassName=e,t.size&&(this._size.height=t.size.height||this._size.height,this._size.width=t.size.width||this._size.width),this._label.options.set(this._getLabelStyleOption())},t.prototype._setSize=function(t){var e=t.height/2,o=t.width/2;this._saveSize(t),this._label.options.set({iconLabelTop:-e,iconLabelLeft:-o,iconShape:{type:"Rectangle",coordinates:[[-o,-e],[o,e]]}})},t.prototype._getLabelStyleOption=function(){var t=this._options,e=t.labelTextClassName,o=t.labelTextColor,n=t.labelTextSize,i=this._size,a=i.width,l=i.height;return{iconLabelClassName:this._isObject(e)?"":e,iconLabelTextSize:this._isObject(n)?"":n,iconLabelTextColor:this._isObject(o)?"":o,iconLabelTop:-l/2,iconLabelLeft:-a/2}},t.prototype._isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},t.prototype.destroy=function(){this.removeFromCollection(),this._label=void 0},t}())}),ymaps.modules.define("LabelForObjectManager",["util.extend","GeoObject","stringReplacer","ObjectManager","Placemark","transformGeoObjectToObject"],function(t,e,o,n,i,a,l){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(e,o,n,i){if(s(this,t),!e||!n)throw new Error("wrong argument");this._geoObject=e,this._parentCollection=i,this._options=o,this._label=null,this._id=null,this._LayoutClass=n,this._initLabel()}return t.prototype.getPlacemark=function(){return this._label},t.prototype.calculateLabelSize=function(o){this.removeFromCollection();var n=o.height/2,i=o.width/2;this._label=t._createPlacemark({properties:e({},this._label.properties.getAll(),{top:-n,left:-i}),options:e({},this._label.options.getAll(),{iconShape:{type:"Rectangle",coordinates:[[-i,-n],[i,n]]}})},this._LayoutClass),this.addToCollection()},t.prototype.removeFromCollection=function(){if(!this._parentCollection)return!1;this._parentCollection instanceof i&&this._id?this._parentCollection.remove(l(this._label,this._id)):this._parentCollection.remove(this._label)},t.prototype.addToCollection=function(){if(!this._parentCollection)return!1;if(this._parentCollection instanceof i){var t="PolygonLabel#"+this._geoObject.id;return this._parentCollection.add(l(this._label,t)),this._id=t,t}this._parentCollection.add(this._label)},t.prototype._initLabel=function(){var e=this._options.labelHtml,o=void 0;o=e||this._createLabelContentWithPresets(),this._label=t._createPlacemark({properties:{html:o},options:this._options},this._LayoutClass)},t._createPlacemark=function(t,o){var n=t.properties,i=t.options;return n=e({},{top:0,left:0,position:"absolute"},n),i=e({},{iconLayout:o},i),new a([0,0],n,i)},t.prototype._createLabelContentWithPresets=function(){var t=this._options,e=t.labelText,o=t.labelTextClassName,i=t.labelTextSize,a=t.outlineColor,l=t.textColor;return n('<div class="$1" style="font-size: $2; color: $3; text-shadow: $4">$5</div>',[o,i,l,"\n        1px 1px 0 "+a+",\n        -1px -1px 0 "+a+",\n        1px -1px 0 "+a+",\n        -1px 1px 0 "+a,e])},t.prototype._initEvents=function(){},t.prototype._labelClick=function(){this._geoObject instanceof o&&this._geoObject.events.fire("labelClick",{targetLabel:this._label})},t.prototype._removeClickEvent=function(){this._label.events.remove("click",this._labelClick,this)},t.prototype.destroy=function(){this._removeClickEvent(),this.removeFromCollection(),this._label=void 0},t}())}),ymaps.modules.define("createLabelLayoutTemplate",["templateLayoutFactory"],function(t,e){t(function(t){return e.createClass('\n    <div {% style %}position: {{options.labelPosition}}; top: {{options.labelTop}}px; left: {{options.labelLeft}}px; {% endstyle %}>\n        <div class="{{options.labelClassName}}"\n            {% style %}font-size: {{options.labelTextSize}}px; color: {{options.labelTextColor}}; {% endstyle %}>\n            '+t+"\n        </div>\n    </div>")})}),ymaps.modules.define("LabelLayoutTemplate",["templateLayoutFactory","config"],function(t,e,o){t(e.createClass(""))}),ymaps.modules.define("PBased",["config","GeoObject","option.presetStorage"],function(t,e,o,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(e){i(this,t),this._map=e}return t.prototype.initMapListeners=function(t){this._mapBoundsChangeCallback=t,this._map.events.add("boundschange",this._mapBoundsChangeHandler,this)},t.prototype.destroyMapListeners=function(){this._map.events.remove("boundschange",this._mapBoundsChangeHandler,this)},t.prototype._mapBoundsChangeHandler=function(t){t.get("newZoom")!==t.get("oldZoom")&&this._mapBoundsChangeCallback()},t.prototype.getOptions=function(t){return e.options.reduce(function(e,n){return e[n]=t instanceof o?t.options.get(n):t.options[n],e},{})},t.prototype.getProperties=function(t){return e.properties.reduce(function(e,n){return e[n]=t instanceof o?t.properties.get(n):t.properties[n],e},{})},t}())}),ymaps.modules.define("PCollection",["util.defineClass","util.objectKeys","PBased","LabelForCollection","setCenter","setZoomVisibilityForGeoObject","setForceVisibleZoom","parseZoomData","createDefaultLabelData","GeoObjectCollection"],function(t,e,o,n,i,a,l,s,r,c,p){function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function n(e,o){u(this,n);var i=h(this,t.call(this,e));return i._map=e,i._labelsCollection=new p,i._labelsState=new WeakMap,i._polygonsCollection=o,i._initData(),i}return e(n,t),n.prototype._updateAll=function(){this._calculateCollections(!0)},n.prototype.destroy=function(){this._clearLabelCollections(),this._deleteListeners()},n.prototype.getLabelState=function(t){return this._labelsState(t)},n.prototype._initData=function(){var t=this;this._map.geoObjects.add(this._labelsCollection),this._calculateCollections(!0).then(function(){t._initMapListeners(),t._initCollectionListeners()})},n.prototype._calculateCollections=function(t){var e=this,o=[];return t&&this._clearLabelCollections(),this._polygonsCollection.each(function(i){t?(e._initPolygonListeners(i),e._calculateGeoObjectLabelData(i).then(function(t){i.properties.set("_labelData",t),o.push(n._analyzeAndSetLabelData(e._map,i))})):o.push(n._analyzeAndSetLabelData(e._map,i))}),Promise.all(o)},n.prototype._clearLabelCollections=function(){this._deletePolygonsListeners(),this._labelsCollection.removeAll(),this._labelsCollection.options.set({pane:"phantom"})},n.prototype._calculateGeoObjectLabelData=function(t,e){var n=this,p=this.getOptions(t),u=this.getProperties(t),h=c();s(h,p.labelForceVisible);var f=t.geometry.getCoordinates();a(h,f,u.labelCenterCoords);var b=void 0;return b=e?t.properties.get("_labelData").label:new i(t,p,u,this._labelsCollection),h.label=b,new Promise(function(t){b.addToCollection().then(function(){var e=p.labelClassName,i=p.labelTextColor,a=p.labelTextSize;e=r(e),a=r(a),i=r(i),o(h.zoomInfo).forEach(function(t){h.zoomInfo[t].style={className:e?e[t]:"",textSize:a?a[t]:"",textColor:i?i[t]:""}}),l(n._map,h,f,b).then(function(){t(h)})})})},n._analyzeAndSetLabelData=function(t,e){return new Promise(function(o){var n=e.properties.get("_labelData");if(n){var i=n.zoomInfo,a=n.autoCenter,l=n.label;i=i[t.getZoom()],l._setCoordinates(i.center||a);var s=void 0===i.visibleForce?i.visible:i.visibleForce;l._setVisibility(s),l._setStyles(i.style),o()}else o()})},n.prototype._recalculateNewGeoObject=function(t){var e=this;this._calculateGeoObjectLabelData(t).then(function(o){t.properties.set("_labelData",o),n._analyzeAndSetLabelData(e._map,t)})},n.prototype._collectionEventHandler=function(t){switch(t.get("type")){case"add":this._recalculateNewGeoObject(t.get("child"));break;case"remove":t.get("child").properties.get("_labelData").label.destroy()}},n.prototype._initPolygonListeners=function(t){t.events.add("optionschange",this._onPolygonEventHandler,this)},n.prototype._onPolygonEventHandler=function(t){var e=this,o=t.get("target");o.properties.get("_labelData").label._setLayout(o.options.get("labelLayout")).then(function(){e._calculateGeoObjectLabelData(o,!0).then(function(t){o.properties.set("_labelData",t),n._analyzeAndSetLabelData(e._map,o)})})},n.prototype._initCollectionListeners=function(){this._polygonsCollection.events.add(["add","remove"],this._collectionEventHandler,this)},n.prototype._initMapListeners=function(){var t=this;this.initMapListeners(function(){t._calculateCollections()})},n.prototype._deleteListeners=function(){this._polygonsCollection.events.remove(["add","remove"],this._collectionEventHandler,this),this.destroyMapListeners()},n.prototype._deletePolygonsListeners=function(){var t=this;this._polygonsCollection.each(function(e){e.events.remove("optionschange",t._onPolygonEventHandler,t)})},n}(n))}),ymaps.modules.define("PObjectManager",["util.defineClass","PBased","CalculatorGeoObjectLabelData","LabelLayoutTemplate"],function(t,e,o,n,i){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function o(e,n){a(this,o);var s=l(this,t.call(this,e));return s._map=e,s._objectManager=n,s._labelLayoutTemplate=i,s._initData(),s}return e(o,t),o.prototype.update=function(){},o.prototype.destroy=function(){},o.prototype.getLabels=function(){},o.prototype._initData=function(){var t=this;this._calculatorGeoObjectLabelData=new n(this._map,this._labelLayoutTemplate,this._objectManager),this._calculatorGeoObjectLabelData.initListenersForObjectManager(),this._calculateCollections(!0).then(function(){t._initMapListeners()})},o.prototype._calculateCollections=function(t){var e=this,o=[];return this._objectManager.objects.each(function(n){t?("string"!=typeof n.id||"string"==typeof n.id&&-1===n.id.indexOf("PolygonLabel"))&&e._calculateGeoObjectLabelData(n).then(function(){o.push(analyzeAndSetLabelData(e._map,n))}):o.push(analyzeAndSetLabelData(e._map,n))}),Promise.all(o)},o.prototype._calculateGeoObjectLabelData=function(e){var o=this,n=t.prototype.getOptions.call(this,e),i=t.prototype.getProperties.call(this,e);return new Promise(function(t){o._calculatorGeoObjectLabelData.getLabelData(e,n,i,o._objectManager).then(function(o){e.properties._labelData=o,t()})})},o.prototype._initMapListeners=function(){t.prototype.initMapListeners.call(this,function(){})},o}(o))}),ymaps.modules.define("Polylabel",["PCollection","PObjectManager","ObjectManager"],function(t,e,o,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(a,l){i(this,t),this._instance=l instanceof n?new o(a,l):new e(a,l)}return t.prototype.getLabelState=function(t){this._instance.getLabelState(t)},t.prototype.destroy=function(){this._instance.destroy()},t}())}),ymaps.modules.define("CalculatorGeoObjectLabelData",["GeoObject","ObjectManager","createDefaultLabelData","setCenter","setZoomVisibility","Label"],function(t,e,o,n,i,a,l){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(e,o,n){s(this,t),this._map=e,this._LabelLayoutTemplate=o,this._data=n,this._storage={}}return t.prototype.getLabelData=function(t,s,r,c){var p=this,u=n(),h=t instanceof e?t.geometry.getCoordinates():t.geometry.coordinates;i(u,h,r.labelCenterCoords);var f=new l(t,s,this._LabelLayoutTemplate,c),b=f.addToCollection();return new Promise(function(t){c instanceof o?b&&(p._storage[b]={resolve:t,labelData:u,labelInst:f,coordinates:h,options:s}):f.getPlacemark().getOverlay().then(function(t){return t.getLayout()}).then(function(e){var o=e.getElement().firstChild.getBoundingClientRect();f.calculateLabelSize(o),f._initEvents(),a(map,u,h,o,s.labelForceVisibleZoom),u.label=f,t(u)})})},t.prototype.removeListenersForObjectManager=function(){this._data.objects.overlays.events.remove("add",this._listenersForOM,this)},t.prototype.initListenersForObjectManager=function(){this._overlaysListener||(this._data.objects.overlays.events.add("add",this._listenersForOM,this),this._data.objects.overlays.events.add("remove",function(t){console.log("remove")},this),this._overlaysListener=!0)},t.prototype._listenersForOM=function(t){console.log("add");var e=t.get("objectId");if("string"==typeof e&&0===e.indexOf("PolygonLabel#")){var o=t.get("overlay");this._storage[e].overlay=o,o.events.add("mapchange",this._mapChangeHandler,{context:this,objectId:e})}},t.prototype._mapChangeHandler=function(t){var e=this;this.context._storage[this.objectId].overlay.getLayout().then(function(t){var o=t.getElement().firstChild.getBoundingClientRect(),n=e.context._storage[e.objectId],i=n.resolve,l=n.labelData,s=n.labelInst,r=n.coordinates,c=n.options,p=n.overlay;s.calculateLabelSize(o),s._initEvents(),a(e.context._map,l,r,o,c.labelForceVisibleZoom),l.label=s,i(l),delete e.context._storage[e.objectId],p.events.remove("mapchange",e.context._mapChangeHandler,e)})},t}())}),ymaps.modules.define("getLabelLayout",[],function(t){t(function(t){return new Promise(function(e,o){t.getOverlay().then(function(t){return t.getLayout()}).then(function(t){e(t)}).catch(function(t){o(t)})})})}),ymaps.modules.define("getLabelSize",[],function(t){t(function(t){return t.getElement().firstChild.getBoundingClientRect()})}),ymaps.modules.define("getLayoutSize",[],function(t){t(function(t){var e=t.getElement();return"#text"!==e.firstChild.nodeName?e.firstChild.getBoundingClientRect():e.lastChild.getBoundingClientRect()})}),ymaps.modules.define("transformGeoObjectToObject",[],function(t){t(function(t,e){return{id:e,type:"Feature",geometry:{type:t.geometry.getType(),coordinates:t.geometry.getCoordinates()},options:t.options.getAll(),properties:t.properties.getAll()}})}),ymaps.modules.define("XPlacemark",["util.defineClass","overlay.Placemark"],function(t,e,o){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function o(e,a,l){return n(this,o),i(this,t.call(this,e,a,l))}return e(o,t),o.prototype.getData=function(){var t=this._data.geoObject.properties.get("labelPolygon");return{geoObject:t,geometry:t.geometry.getCoordinates(),properties:t.properties,state:t.state}},o}(o))}),ymaps.modules.define("setPresets",["util.extend","option.presetStorage"],function(t,e,o){function n(t){var o=["Big","Small"],n=["BlackInWhiteOutline","WhiteInBlackOutline"];o.forEach(function(o){t.add(""+s+o,e({},l[o]))}),n.forEach(function(o){t.add(""+s+o,e({},l[o]))}),o.forEach(function(o){n.forEach(function(n){t.add(""+s+o+n,e({},l[o],l[n]))})})}function i(t){return{labelTextSize:t}}function a(t,e){return{textColor:t,outlineColor:e}}var l={Big:i("20px"),Small:i("12px"),BlackInWhiteOutline:a("black","white"),WhiteInBlackOutline:a("white","black")},s="polylabel#";t(function(){o.add("polylabel#default",e({},i("16px"),a("black"))),n(o)})}),ymaps.modules.define("util.createPolylabel",["Polylabel"],function(t,e){t(function(t,o){return new e(t,o)})}),ymaps.modules.define("checkPointPosition",[],function(t){function e(t,e,a){var l=o(a,e),s=o(t,e),r=l[0]*s[1]-s[0]*l[1];return r>0?"LEFT":r<0?"RIGHT":l[0]*s[0]<0||l[1]*s[1]<0?"BEHIND":n(l)<n(s)?"BEYOND":i(e,t)?"ORIGIN":i(a,t)?"DESTINATION":"BETWEEN"}function o(t,e){return[t[0]-e[0],t[1]-e[1]]}function n(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function i(t,e){return t[0]===e[0]&&t[1]===e[1]}function a(t,o){var n=o[0],i=o[1];switch(e(t,n,i)){case"LEFT":return n[1]<t[1]&&t[1]<=i[1]?"CROSSING":"INESSENTIAL";case"RIGHT":return i[1]<t[1]&&t[1]<=n[1]?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}}t(function(t,e){for(var o=0,n=0;n<e.length-1;n++)switch(a(t,[e[n],e[n+1]])){case"TOUCHING":return"BOUNDARY";case"CROSSING":o=1-o}return o?"INSIDE":"OUTSIDE"})}),ymaps.modules.define("createDefaultLabelData",["config"],function(t,e){var o=e.MIN_ZOOM,n=e.MAX_ZOOM;t(function(){for(var t=o,e={zoomInfo:{},autoCenter:[0,0],polygonIndex:0};t<=n;)e.zoomInfo[t]={visible:!1,visibleForce:void 0,center:void 0,style:{className:void 0,textSize:void 0,textColor:void 0,size:{width:void 0,height:void 0}}},t++;return e})}),ymaps.modules.define("getPolesOfInaccessibility",["util.calculateArea"],function(t,e){function o(t,e){if(!(this instanceof o))return new o(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||n,this.length>0)for(var i=this.length>>1;i>=0;i--)this._down(i)}function n(t,e){return t<e?-1:t>e?1:0}function i(t,e,o){e=e||1;for(var n,i,s,c,u=0;u<t[0].length;u++){var h=t[0][u];(!u||h[0]<n)&&(n=h[0]),(!u||h[1]<i)&&(i=h[1]),(!u||h[0]>s)&&(s=h[0]),(!u||h[1]>c)&&(c=h[1])}var f=s-n,b=c-i,d=Math.min(f,b),_=d/2,y=new p(null,a);if(0===d)return[n,i];for(var m=n;m<s;m+=d)for(var g=i;g<c;g+=d)y.push(new l(m+_,g+_,_,t));var v=r(t),C=new l(n+f/2,i+b/2,0,t);C.d>v.d&&(v=C);for(var L=y.length;y.length;){var O=y.pop();O.d>v.d&&(v=O,o&&console.error("found best %d after %d probes",Math.round(1e4*O.d)/1e4,L)),O.max-v.d<=e||(_=O.h/2,y.push(new l(O.x-_,O.y-_,_,t)),y.push(new l(O.x+_,O.y-_,_,t)),y.push(new l(O.x-_,O.y+_,_,t)),y.push(new l(O.x+_,O.y+_,_,t)),L+=4)}return o&&(console.error("num probes: "+L),console.error("best distance: "+v.d)),[v.x,v.y]}function a(t,e){return e.max-t.max}function l(t,e,o,n){this.x=t,this.y=e,this.h=o,this.d=s(t,e,n),this.max=this.d+this.h*Math.SQRT2}function s(t,e,o){for(var n=!1,i=1/0,a=0;a<o.length;a++)for(var l=o[a],s=0,r=l.length,p=r-1;s<r;p=s++){var u=l[s],h=l[p];u[1]>e!=h[1]>e&&t<(h[0]-u[0])*(e-u[1])/(h[1]-u[1])+u[0]&&(n=!n),i=Math.min(i,c(t,e,u,h))}return(n?1:-1)*Math.sqrt(i)}function r(t){for(var e=0,o=0,n=0,i=t[0],a=0,s=i.length,r=s-1;a<s;r=a++){var c=i[a],p=i[r],u=c[0]*p[1]-p[0]*c[1];o+=(c[0]+p[0])*u,n+=(c[1]+p[1])*u,e+=3*u}return 0===e?new l(i[0][0],i[0][1],0,t):new l(o/e,n/e,0,t)}function c(t,e,o,n){var i=o[0],a=o[1],l=n[0]-i,s=n[1]-a;if(0!==l||0!==s){var r=((t-i)*l+(e-a)*s)/(l*l+s*s);r>1?(i=n[0],a=n[1]):r>0&&(i+=l*r,a+=s*r)}return l=t-i,s=e-a,l*l+s*s}t(function(t,o,n){if(void 0===e)throw new Error("Didn't find calculateArea module");var a=Number.MIN_VALUE,l=0,s=void 0;if(t.length>1){for(var r=0;r<t.length;r++){var c=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:[t[r]]}}),p=Math.round(e(c));a<p&&(a=p,l=r)}s=[t[l]]}else s=t;return{center:i(s,o,n),index:l}}),o.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return--this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,o=this.compare,n=e[t];t>0;){var i=t-1>>1,a=e[i];if(o(n,a)>=0)break;e[t]=a,t=i}e[t]=n},_down:function(t){for(var e=this.data,o=this.compare,n=this.length>>1,i=e[t];t<n;){var a=1+(t<<1),l=a+1,s=e[a];if(l<this.length&&o(e[l],s)<0&&(a=l,s=e[l]),o(s,i)>=0)break;e[t]=s,t=a}e[t]=i}};var p=o}),ymaps.modules.define("stringReplacer",[],function(t){t(function(t,e){var o=t;return e.forEach(function(t,e){o=o.replace(new RegExp("\\$"+(e+1),"g"),t)}),o})}),ymaps.modules.define("getFirstZoomInside",["checkPointPosition","config"],function(t,e,o){function n(t,e,o,n){var i=t.options.get("projection").toGlobalPixels(e,o),a=n.width,l=n.height,s=[];return s.push([i[0]-a/2,i[1]-l/2],[i[0]-a/2,i[1]+l/2],[i[0]+a/2,i[1]-l/2],[i[0]+a/2,i[1]+l/2]),s}function i(t,o,n,i){for(var a=0;a<n.length;a++){var l=t.options.get("projection").fromGlobalPixels(n[a],i);if("INSIDE"!==e(l,o))return!1}return!0}t(function(t,e,a,l){for(var s=o.MIN_ZOOM,r=o.MAX_ZOOM,c=void 0;s<r;)i(t,a,n(t,e,c=Math.floor((s+r)/2),l),c)?r=c:s=c+1;return s})}),ymaps.modules.define("parseZoomData",["util.objectKeys","config"],function(t,e,o){function n(t,e,o){t[e]=o}function i(t,e,o){if(isNaN(Number(e))){var n=e.split("_").map(Number);if(!isNaN(n[0])&&!isNaN(n[1]))for(var i=n[0]<s?s:n[0],a=n[1]>r?r:n[1];i<=a;)t[i]=o,i++}else t[Number(e)]=o}function a(t){for(var e=s,o={};e<=r;)o[e]=t,e++;return o}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=o.MIN_ZOOM,r=o.MAX_ZOOM;t(function(t){var o=["number","string","boolean"];return"[object Object]"===Object.prototype.toString.call(t)?e(t).reduce(function(e,o){return"string"==typeof o?i(e,o,t[o]):"number"==typeof o&&n(e,o,t[o]),e},a()):o.includes(void 0===t?"undefined":l(t))?a(t):void 0})}),ymaps.modules.define("setForceVisibleZoom",["util.objectKeys","parseZoomData"],function(t,e,o){t(function(t,n){if("boolean"==typeof n)e(t.zoomInfo).forEach(function(e){t.zoomInfo[e].visibleForce=n});else if("[object Object]"===Object.prototype.toString.call(n)){var i=o(n);e(i).forEach(function(e){void 0!==i[e]&&(t.zoomInfo[e].visibleForce=i[e])})}})}),ymaps.modules.define("setZoomVisibility",["util.objectKeys","getFirstZoomInside"],function(t,e,o){t(function(t,n,i,a,l){var s=o(t,n.autoCenter,i,a);e(n.zoomInfo).forEach(function(e){if(n.zoomInfo[e].center){var l=o(t,n.zoomInfo[e].center,i,a);n.zoomInfo[e].visible=e>=l}else n.zoomInfo[e].visible=e>=s})})}),ymaps.modules.define("setZoomVisibilityForGeoObject",["util.objectKeys","getFirstZoomInside","getLayoutSize","getLabelLayout"],function(t,e,o,n,i){function a(t,e,i,a,l,s,r){return new Promise(function(c){var p=i.zoomInfo[a],u=p.style.className+"_"+p.style.textSize;if(r[u])return p.visible=a>=r[u],void c();e._setStyles(p.style);var h=n(s);e._setSize(h),p.style.size={width:h.width,height:h.height};var f=o(t,p.center||i.autoCenter,l[i.polygonIndex],h);p.visible=a>=f,r[u]=f,c()})}t(function(t,o,n,i){var l=[],s={};return e(o.zoomInfo).forEach(function(e){l.push(a(t,i,o,e,n,i.getLayout(),s))}),Promise.all(l)})});